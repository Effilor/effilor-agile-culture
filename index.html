<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agile Culture Assessment | Effilor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }
        
        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }
        
        .primary-color {
            color: #6B3D7A;
        }
        
        .bg-primary {
            background-color: #6B3D7A;
        }
        
        .border-primary {
            border-color: #6B3D7A;
        }
        
        .answer-option {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid #e0e0e0;
            background: white;
        }
        
        .answer-option:hover {
            border-color: #6B3D7A;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 61, 122, 0.15);
        }
        
        .answer-option.selected {
            border-color: #6B3D7A;
            background: linear-gradient(135deg, #6B3D7A 0%, #8B5A9E 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(107, 61, 122, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6B3D7A 0%, #8B5A9E 100%);
            color: white;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(107, 61, 122, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #6B3D7A;
            border: 2px solid #6B3D7A;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #6B3D7A;
            color: white;
            transform: translateY(-2px);
        }
        
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .progress-bar {
            transition: width 0.4s ease;
            background: linear-gradient(90deg, #6B3D7A 0%, #8B5A9E 100%);
        }
        
        .pillar-badge {
            display: inline-block;
            padding: 6px 16px;
            background: rgba(107, 61, 122, 0.1);
            color: #6B3D7A;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .score-badge {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6B3D7A 0%, #8B5A9E 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .strength-box {
            border-left: 4px solid #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .priority-box {
            border-left: 4px solid #f59e0b;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        .pillar-bar {
            height: 32px;
            background: #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }
        
        .pillar-fill {
            height: 100%;
            border-radius: 8px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .level-emerging { background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%); }
        .level-developing { background: linear-gradient(90deg, #3b82f6 0%, #60a5fa 100%); }
        .level-strong { background: linear-gradient(90deg, #10b981 0%, #34d399 100%); }
        
        input[type="text"], input[type="email"], input[type="tel"] {
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus {
            outline: none;
            border-color: #6B3D7A;
            box-shadow: 0 0 0 3px rgba(107, 61, 122, 0.1);
        }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen py-8 px-4"></div>

    <script>
        // Logo URL
        const LOGO_URL = "./effilor-logo.jpg";
        
        // Assessment data
        const ASSESSMENT_DATA = {
            name: "Agile Culture Assessment",
            totalQuestions: 26,
            pillars: [
                { id: 1, name: "Agile Principle", description: "Understanding & Application", maxScore: 45, questionCount: 9 },
                { id: 2, name: "Trust", description: "Psychological Safety & Empowerment", maxScore: 50, questionCount: 10 },
                { id: 3, name: "Self Organizing", description: "Team Autonomy", maxScore: 30, questionCount: 6 },
                { id: 4, name: "Collaborate", description: "Working Together", maxScore: 30, questionCount: 6 },
                { id: 5, name: "Sustainable Pace", description: "Predictability & Balance", maxScore: 30, questionCount: 6 },
                { id: 6, name: "Retrospectives", description: "Learning Culture", maxScore: 30, questionCount: 6 }
            ],
            pillarFeedback: {
                1: { // Agile Principle
                    strong: "Your teams demonstrate sophisticated understanding of why Agile practices matter, not just how to perform them. Sprint ceremonies serve their intended purposes: planning is collaborative, stand-ups facilitate team coordination, reviews generate meaningful client dialogue, and retrospectives drive genuine improvement. Information flows transparently across the organization, enabling effective decision-making at all levels.",
                    developing: "Your organization understands and practices core Agile principles in most contexts, but application isn't yet consistent or comprehensive. Sprint ceremonies happen regularly and generally serve their purpose, but quality varies by team or situation. Information sharing is better than traditional organizations, but gaps remain - particularly around client/stakeholder context or strategic direction.",
                    emerging: "Your teams follow Agile ceremonies mechanically without fully understanding their purpose or value. Sprint planning happens but may exclude developers from active participation. Stand-ups become status reports to leads rather than team coordination sessions. Retrospectives occur sporadically or avoid discussing real behavioral and cultural issues.",
                    needs: "Your organization has adopted Agile language while maintaining traditional hierarchical practices. Ceremonies may occur on schedule, but they don't serve Agile purposes. Planning is done by leads who assign work. Stand-ups are status updates for managers. Reviews lack genuine client participation or feedback integration."
                },
                2: { // Trust
                    strong: "Your organization has created an environment of genuine psychological safety and empowerment. Team members ask for help openly, volunteer to assist others, and collaborate across boundaries without seeking permission. Everyone's input is valued regardless of role or seniority. Managers operate as impediment removers and capability builders rather than task assigners and controllers.",
                    developing: "Your organization demonstrates good trust within teams, but empowerment boundaries remain unclear or inconsistently applied. Team members collaborate well with their immediate colleagues but still seek management approval for decisions they could reasonably own. People generally feel safe asking for help from peers, but may hesitate to raise concerns to leadership.",
                    emerging: "Trust in your organization exists primarily in pockets - certain teams or relationships demonstrate psychological safety while others operate with traditional hierarchy and caution. Team members are generally respectful and will help each other when explicitly asked, but they don't proactively volunteer assistance. Permission-seeking is the norm for any work outside assigned tasks.",
                    needs: "Your organization operates with traditional hierarchical control that fundamentally undermines Agile principles. Team members are reluctant to ask for help, seeing it as admission of weakness rather than normal collaboration. They wait for task assignments rather than self-organizing, and seek permission before taking any initiative outside prescribed responsibilities."
                },
                3: { // Self Organizing
                    strong: "Your teams demonstrate genuine self-organization - coordinating work among themselves, resolving dependencies through direct collaboration, and making decisions without waiting for management direction. Team members understand not just their individual tasks but the purpose behind the work, enabling them to adapt when circumstances change.",
                    developing: "Your teams show capable self-organization in familiar contexts but revert to seeking direction when faced with ambiguity or pressure. Most team members participate actively in planning and understand the broader purpose behind their work, but some still focus narrowly on assigned tasks. When blocked, people generally try to solve problems with peers first, though escalation to management remains common.",
                    emerging: "Your teams demonstrate limited self-organization, heavily relying on leads or managers for direction and task assignment. While some collaboration occurs - people will help each other when asked - there's little proactive coordination or problem-solving among peers. Team members wait for planning outcomes rather than actively shaping them.",
                    needs: "Your teams operate in a strictly hierarchical, task-assignment model that contradicts Agile principles entirely. Planning is done by leads or managers who then assign work; developers are implementers, not collaborators in shaping the work. Team members focus on executing their assigned tasks without understanding or concerning themselves with broader sprint goals."
                },
                4: { // Collaborate
                    strong: "Your teams demonstrate sophisticated collaboration that goes beyond task coordination to genuine partnership. Everyone's input is valued regardless of role or tenure, creating rich discussions that surface important concerns and creative solutions. Team members proactively support each other - not just when asked, but by noticing when colleagues struggle and offering assistance.",
                    developing: "Your teams collaborate well within familiar contexts and established relationships, but coordination breaks down when spanning boundaries or facing ambiguous situations. Most team members will help when asked, but proactive assistance is inconsistent. Planning and decision-making generally include diverse voices, though some perspectives may dominate.",
                    emerging: "Your organization demonstrates transactional rather than collaborative teamwork. People attend meetings together and will help each other when explicitly requested, but interactions remain largely work-focused and impersonal. Diverse perspectives aren't actively sought - the same voices tend to dominate planning and decision discussions while others passively listen.",
                    needs: "Your organization operates with siloed, individual-focused work patterns that prevent effective collaboration. Team members work in parallel rather than together, coordinating only when dependencies force interaction. Meetings happen but function as information broadcasts rather than collaborative discussions."
                },
                5: { // Sustainable Pace
                    strong: "Your teams maintain sustainable pace through intelligent planning, disciplined execution, and effective boundary management. Estimates are team-driven based on actual capacity, not external pressure or wishful thinking. Work is distributed evenly across the sprint rather than back-loaded. Teams meet sprint goals predictably because commitment and capacity are well-calibrated.",
                    developing: "Your teams generally maintain sustainable pace, but it breaks down under pressure or in specific contexts. Most sprints are planned reasonably and workload is fairly balanced, but there are recurring patterns of last-minute intensity suggesting planning gaps or coordination issues. Teams usually meet sprint goals, though sometimes through heroic effort.",
                    emerging: "Your teams experience chronic unsustainable pace, though you may have normalized this as 'how work gets done.' Sprint planning is heavily influenced by external pressure rather than team capacity and historical velocity. Work is unevenly distributed - some sprints are overloaded while in others teams are idle waiting for work.",
                    needs: "Your teams operate in permanent crisis mode with fundamentally unsustainable pace. Sprint planning is wishful thinking - commitments are driven entirely by external pressure with little connection to team capacity or historical performance. Work is severely back-loaded as teams scramble to deliver anything by sprint end."
                },
                6: { // Retrospectives
                    strong: "Your organization treats retrospectives as a cornerstone of continuous improvement, not a ceremony to check off. Retrospectives happen consistently with full participation from all team members. Discussions address real issues including difficult interpersonal or cultural matters, not just safe process topics. Everyone shares views openly because genuine psychological safety exists.",
                    developing: "Your retrospectives generally occur and generate useful insights, but they haven't become the powerful learning engine they could be. Most team members participate, though a few voices tend to dominate while others listen more than contribute. Discussions are constructive but sometimes stay at the surface, identifying symptoms without digging into root causes.",
                    emerging: "Your retrospectives happen sporadically and generate limited value when they do occur. Participation is uneven - some team members engage actively while others remain silent or don't attend. Discussions focus on safe, technical process issues while avoiding difficult interpersonal, behavioral, or cultural topics.",
                    needs: "Your retrospectives either don't happen consistently or are so superficial they add no value. When held, they're often cancelled if there's any work pressure, signaling they're considered optional overhead rather than essential practice. Participation is poor - team members don't see the point and attend only if required."
                }
            },
            questions: [
                { id: 1, text: "Only Team Leads and Business Analysts participate in the sprint planning", pillar: 1, reverse: true },
                { id: 2, text: "Everyone's inputs are considered while estimating effort irrespective of their roles", pillar: 2, reverse: false },
                { id: 3, text: "Client pressure determines effort estimates", pillar: 5, reverse: true },
                { id: 4, text: "Managers are quick to help at the first sign of team struggling to meet sprint goals", pillar: 2, reverse: false },
                { id: 5, text: "Team members only understand their tasks and not the purpose behind each backlog item", pillar: 3, reverse: true },
                { id: 6, text: "Sprint Review meetings are open and transparent", pillar: 1, reverse: false },
                { id: 7, text: "Sensitive behaviour and people related issues are not brought up during retrospectives", pillar: 1, reverse: true },
                { id: 8, text: "Progress Updates are provided to Leaders during daily stand ups", pillar: 1, reverse: true },
                { id: 9, text: "Learnings from previous sprints are always incorporated during the next planning meeting", pillar: 6, reverse: false },
                { id: 10, text: "Team members provide updates to each other", pillar: 2, reverse: false },
                { id: 11, text: "I get my superiors permission before taking up somebody else's task", pillar: 2, reverse: true },
                { id: 12, text: "Customers/Stakeholders Participate in Sprint Reviews", pillar: 3, reverse: false },
                { id: 13, text: "All members in the team are equally loaded during the entire sprint duration", pillar: 2, reverse: false },
                { id: 14, text: "I hesitate to ask for help openly when I am stuck", pillar: 3, reverse: true },
                { id: 15, text: "Retrospectives are effective in identifying learnings", pillar: 2, reverse: false },
                { id: 16, text: "Team Leads assign tasks during daily standups", pillar: 1, reverse: true },
                { id: 17, text: "Teams meet sprint goals predictably", pillar: 5, reverse: false },
                { id: 18, text: "We demonstrate Agility by accepting scope changes during the sprint", pillar: 5, reverse: true },
                { id: 19, text: "Team members do not proactively volunteer to assist other team members to meet sprint goals", pillar: 2, reverse: true },
                { id: 20, text: "Team members promptly escalate challenges to their managers", pillar: 2, reverse: true },
                { id: 21, text: "A few people dominate retrospective discussions", pillar: 1, reverse: true },
                { id: 22, text: "All information related to Client/Project is available to team members to make effective decisions", pillar: 1, reverse: false },
                { id: 23, text: "Everyone shares views openly during retrospectives", pillar: 1, reverse: false },
                { id: 24, text: "Healthy debates occur during sprint review meetings", pillar: 1, reverse: false },
                { id: 25, text: "Team members resolve internal dependencies among themselves to meet sprint goals", pillar: 3, reverse: false },
                { id: 26, text: "Managers actively influence learnings during retrospectives", pillar: 2, reverse: true }
            ]
        };

        // State
        let currentScreen = 'welcome';
        let currentQuestion = 0;
        let answers = {};
        let userData = {};

        // Screen rendering functions
        function renderWelcome() {
            return `
                <div class="max-w-4xl mx-auto fade-in">
                    <div class="bg-white rounded-2xl shadow-2xl p-12">
                        <div class="text-center mb-8">
                            <img src="${LOGO_URL}" alt="Effilor" class="mx-auto mb-8" style="max-width: 300px;">
                            <h1 class="text-5xl font-bold primary-color mb-4">${ASSESSMENT_DATA.name}</h1>
                            <p class="text-xl text-gray-600 mb-8">Diagnose your organization's Agile culture maturity</p>
                        </div>
                        
                        <div class="grid md:grid-cols-3 gap-6 mb-10">
                            <div class="text-center p-6 bg-gray-50 rounded-lg">
                                <div class="text-4xl font-bold primary-color mb-2">${ASSESSMENT_DATA.totalQuestions}</div>
                                <div class="text-gray-600">Questions</div>
                            </div>
                            <div class="text-center p-6 bg-gray-50 rounded-lg">
                                <div class="text-4xl font-bold primary-color mb-2">8-10</div>
                                <div class="text-gray-600">Minutes</div>
                            </div>
                            <div class="text-center p-6 bg-gray-50 rounded-lg">
                                <div class="text-4xl font-bold primary-color mb-2">${ASSESSMENT_DATA.pillars.length}</div>
                                <div class="text-gray-600">Dimensions</div>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 rounded-xl p-8 mb-8">
                            <h3 class="text-2xl font-bold primary-color mb-4">What You'll Discover</h3>
                            <ul class="space-y-3 text-gray-700">
                                <li class="flex items-start">
                                    <span class="primary-color mr-3 text-2xl">•</span>
                                    <span><strong>Overall Agile Maturity:</strong> Where your organization stands on the Agile culture spectrum</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="primary-color mr-3 text-2xl">•</span>
                                    <span><strong>Pillar-by-Pillar Analysis:</strong> Specific strengths and gaps across ${ASSESSMENT_DATA.pillars.length} critical dimensions</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="primary-color mr-3 text-2xl">•</span>
                                    <span><strong>Priority Areas:</strong> Where to focus improvement efforts for maximum impact</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="primary-color mr-3 text-2xl">•</span>
                                    <span><strong>Actionable Insights:</strong> Specific recommendations based on your score profile</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="startAssessment()" class="btn-primary px-12 py-4 rounded-full text-xl font-semibold">
                                Begin Assessment
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderQuestion() {
            const question = ASSESSMENT_DATA.questions[currentQuestion];
            const pillar = ASSESSMENT_DATA.pillars.find(p => p.id === question.pillar);
            const progress = ((currentQuestion + 1) / ASSESSMENT_DATA.totalQuestions) * 100;
            
            return `
                <div class="max-w-3xl mx-auto fade-in">
                    <div class="mb-6">
                        <img src="${LOGO_URL}" alt="Effilor" class="mx-auto" style="max-width: 120px;">
                    </div>
                    
                    <div class="bg-white rounded-2xl shadow-2xl p-8 md:p-12">
                        <div class="mb-8">
                            <div class="flex justify-center items-center mb-2">
                                <span class="text-sm font-medium primary-color">${Math.round(progress)}% Complete</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 max-w-md mx-auto">
                                <div class="progress-bar h-2 rounded-full" style="width: ${progress}%"></div>
                            </div>
                        </div>
                        
                        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-8">${question.text}</h2>
                        
                        <div class="space-y-3 mb-8">
                            ${renderAnswerOptions()}
                        </div>
                        
                        <div class="flex justify-start">
                            ${currentQuestion > 0 ? '<button onclick="previousQuestion()" class="btn-secondary px-6 py-3 rounded-full font-semibold">← Previous</button>' : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAnswerOptions() {
            const options = [
                { value: 1, label: 'Strongly Disagree' },
                { value: 2, label: 'Disagree' },
                { value: 3, label: 'Neutral/Sometimes' },
                { value: 4, label: 'Agree' },
                { value: 5, label: 'Strongly Agree' }
            ];
            
            return options.map(option => `
                <div class="answer-option p-4 rounded-lg ${answers[currentQuestion] === option.value ? 'selected' : ''}" 
                     onclick="selectAnswer(${option.value})">
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border-2 mr-3 flex items-center justify-center ${answers[currentQuestion] === option.value ? 'border-white bg-white' : 'border-gray-300'}">
                            ${answers[currentQuestion] === option.value ? '<div class="w-3 h-3 rounded-full bg-primary"></div>' : ''}
                        </div>
                        <span class="font-medium">${option.label}</span>
                    </div>
                </div>
            `).join('');
        }

        function calculateResults() {
            let totalScore = 0;
            const pillarScores = {};
            
            ASSESSMENT_DATA.pillars.forEach(pillar => {
                pillarScores[pillar.id] = { score: 0, maxScore: pillar.maxScore, name: pillar.name, description: pillar.description };
            });
            
            ASSESSMENT_DATA.questions.forEach((question, index) => {
                const answer = answers[index];
                const score = question.reverse ? (6 - answer) : answer;
                totalScore += score;
                pillarScores[question.pillar].score += score;
            });
            
            return { totalScore, pillarScores };
        }

        function getScoreLevel(totalScore) {
            if (totalScore >= 96) return { name: 'Maturing Agile Culture', color: 'green' };
            if (totalScore >= 61) return { name: 'Agile in Form, Not Function', color: 'orange' };
            return { name: 'Command-and-Control Culture', color: 'red' };
        }

        function getPillarLevel(percentage) {
            if (percentage >= 81) return { name: 'Agile Maturity', color: 'green', class: 'level-strong' };
            if (percentage >= 61) return { name: 'Developing Strength', color: 'blue', class: 'level-developing' };
            if (percentage >= 41) return { name: 'Emerging Capability', color: 'orange', class: 'level-emerging' };
            return { name: 'Needs Urgent Attention', color: 'red', class: 'level-emerging' };
        }

        function getPillarFeedback(pillarId, percentage) {
            const feedback = ASSESSMENT_DATA.pillarFeedback[pillarId];
            if (percentage >= 81) return feedback.strong;
            if (percentage >= 61) return feedback.developing;
            if (percentage >= 41) return feedback.emerging;
            return feedback.needs;
        }

        function getOverallFeedback(totalScore) {
            if (totalScore >= 96) {
                return `<p class="mb-4">Your organization demonstrates genuine Agile practices across most dimensions. Teams exhibit real autonomy, collaborate effectively, and demonstrate the psychological safety required for honest communication and continuous improvement. The principles behind Agile ceremonies are understood and practiced, not just performed mechanically.</p>
                <p class="mb-4">However, high scores don't mean perfection or that you should stop evolving. Even strong Agile cultures develop subtle patterns that limit their effectiveness. Pay particular attention to any individual pillar scores below 75% - these represent pockets where old patterns persist despite overall cultural maturity.</p>
                <p>The competitive advantage of your Agile maturity requires active maintenance. As your organization grows or faces pressure, practices can drift back toward control and efficiency at the expense of empowerment and innovation. Regular cultural diagnostics and ongoing coaching for leaders will help sustain your current strengths.</p>`;
            } else if (totalScore >= 61) {
                return `<p class="mb-4">Your organization has progressed beyond mere ceremony adoption, but Agile principles haven't fully permeated daily practices. Teams show pockets of genuine Agile behavior, but inconsistency suggests the culture hasn't been systematically developed. Some teams or managers have internalized Agile values while others maintain traditional patterns.</p>
                <p class="mb-4">This middle ground is the most dangerous place to stall. Teams see enough Agile benefits to know what's possible, but experience enough friction to get frustrated. The inconsistency creates confusion about "how we actually work here" versus "how we say we work." High performers may leave for organizations with more mature Agile cultures.</p>
                <p>The breakthrough requires moving from manager-dependent to principle-driven execution. This means coaching managers to recognize and resist their reflexive control behaviors, explicitly defining decision boundaries where teams have full authority, and creating structures that reinforce peer-to-peer problem-solving over escalation.</p>`;
            } else {
                return `<p class="mb-4">Your organization has adopted Agile terminology and ceremonies, but the execution reveals deeply entrenched traditional management practices. Teams operate in a command-and-control environment where managers assign tasks, team members wait for instructions, and autonomy is more rhetoric than reality.</p>
                <p class="mb-4">The cost of this disconnect is significant. Despite running sprints and holding stand-ups, your teams aren't experiencing the productivity gains, innovation, or employee engagement that genuine Agile cultures deliver. You're incurring the overhead of Agile ceremonies without capturing the benefits.</p>
                <p>The path forward requires acknowledging this is fundamentally a leadership challenge, not a team capability gap. Managers need coaching on servant leadership, setting boundaries for empowerment rather than controlling execution, and shifting from directive to facilitative approaches. Until leadership demonstrates genuine commitment to autonomy and psychological safety, Agile transformation will remain surface-level.</p>`;
            }
        }

        function renderResults() {
            const results = calculateResults();
            const scoreLevel = getScoreLevel(results.totalScore);
            
            const pillarArray = Object.values(results.pillarScores).map(p => ({
                ...p,
                percentage: Math.round((p.score / p.maxScore) * 100),
                level: getPillarLevel(Math.round((p.score / p.maxScore) * 100))
            }));
            
            const topStrength = pillarArray.reduce((max, p) => p.percentage > max.percentage ? p : max);
            const priorityArea = pillarArray.reduce((min, p) => p.percentage < min.percentage ? p : min);
            
            return `
                <div class="max-w-5xl mx-auto fade-in">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-12">
                            <img src="${LOGO_URL}" alt="Effilor" class="mx-auto mb-6" style="max-width: 180px;">
                            <h1 class="text-4xl md:text-5xl font-bold primary-color mb-4">Your Agile Culture Assessment Results</h1>
                        </div>
                        
                        <div class="text-center mb-12 p-8 bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl">
                            <div class="score-badge mb-4">${results.totalScore} / 130</div>
                            <div class="inline-block px-6 py-3 bg-${scoreLevel.color}-100 text-${scoreLevel.color}-800 rounded-full text-xl font-bold mb-6">
                                ${scoreLevel.name}
                            </div>
                            <div class="text-left text-gray-700 max-w-3xl mx-auto">
                                ${getOverallFeedback(results.totalScore)}
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-12">
                            <div class="strength-box p-6 rounded-xl">
                                <div class="flex items-center mb-3">
                                    <span class="text-3xl mr-3">✓</span>
                                    <h3 class="text-xl font-bold text-green-800">Top Strength</h3>
                                </div>
                                <p class="text-lg font-semibold text-green-900">${topStrength.name}</p>
                                <p class="text-green-700">${topStrength.percentage}% - ${topStrength.level.name}</p>
                            </div>
                            
                            <div class="priority-box p-6 rounded-xl">
                                <div class="flex items-center mb-3">
                                    <span class="text-3xl mr-3">⚠</span>
                                    <h3 class="text-xl font-bold text-orange-800">Priority Area</h3>
                                </div>
                                <p class="text-lg font-semibold text-orange-900">${priorityArea.name}</p>
                                <p class="text-orange-700">${priorityArea.percentage}% - ${priorityArea.level.name}</p>
                            </div>
                        </div>
                        
                        <div class="mb-12">
                            <h2 class="text-3xl font-bold primary-color mb-6">Pillar-by-Pillar Analysis</h2>
                            <div class="space-y-8">
                                ${pillarArray.map((pillar, idx) => `
                                    <div class="border-l-4 border-${pillar.level.color}-500 pl-6 py-4 bg-gray-50 rounded-r-xl">
                                        <div class="flex justify-between items-center mb-3">
                                            <h3 class="text-2xl font-bold text-gray-800">${pillar.name}</h3>
                                            <span class="text-2xl font-bold primary-color">${pillar.percentage}%</span>
                                        </div>
                                        <div class="pillar-bar mb-4">
                                            <div class="pillar-fill ${pillar.level.class}" style="width: ${pillar.percentage}%">
                                                ${pillar.percentage}%
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <span class="inline-block px-4 py-1 bg-${pillar.level.color}-100 text-${pillar.level.color}-800 rounded-full text-sm font-semibold">
                                                ${pillar.level.name}
                                            </span>
                                        </div>
                                        <p class="text-gray-700 leading-relaxed">
                                            ${getPillarFeedback(idx + 1, pillar.percentage)}
                                        </p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="text-center bg-purple-50 rounded-xl p-8 border-2 border-purple-200">
                            <h3 class="text-2xl font-bold primary-color mb-4">Want a Copy of Your Results?</h3>
                            <p class="text-gray-700 mb-6">Receive a comprehensive report with your complete assessment results, detailed recommendations, and actionable next steps tailored to your organization's Agile culture profile.</p>
                            <button onclick="showEmailForm()" class="btn-primary px-10 py-4 rounded-full text-lg font-semibold">
                                Email Me My Results
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEmailForm() {
            return `
                <div class="max-w-2xl mx-auto fade-in">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 md:p-12">
                        <div class="text-center mb-8">
                            <img src="${LOGO_URL}" alt="Effilor" class="mx-auto mb-6" style="max-width: 150px;">
                            <h2 class="text-3xl font-bold primary-color mb-3">Email Me My Results</h2>
                            <p class="text-gray-600">Receive a copy of your complete Agile Culture Assessment results</p>
                        </div>
                        
                        <form onsubmit="submitForm(event)" class="space-y-5">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name *</label>
                                <input type="text" required class="w-full p-3 rounded-lg" placeholder="Your full name">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address *</label>
                                <input type="email" required class="w-full p-3 rounded-lg" placeholder="your.email@company.com">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Organization Name *</label>
                                <input type="text" required class="w-full p-3 rounded-lg" placeholder="Your organization">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Job Role/Title *</label>
                                <input type="text" required class="w-full p-3 rounded-lg" placeholder="Your role">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Phone Number (Optional)</label>
                                <input type="tel" class="w-full p-3 rounded-lg" placeholder="+91 98765 43210">
                            </div>
                            
                            <div class="text-xs text-gray-500 bg-gray-50 p-4 rounded-lg">
                                Your information is confidential and will only be used to send your report and provide follow-up support if needed.
                            </div>
                            
                            <div class="flex gap-4">
                                <button type="button" onclick="backToResults()" class="btn-secondary flex-1 py-3 rounded-full font-semibold">
                                    ← Back to Results
                                </button>
                                <button type="submit" class="btn-primary flex-1 py-3 rounded-full font-semibold">
                                    Email My Results
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderThankYou() {
            return `
                <div class="max-w-2xl mx-auto fade-in">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 md:p-12 text-center">
                        <img src="${LOGO_URL}" alt="Effilor" class="mx-auto mb-6" style="max-width: 180px;">
                        
                        <div class="text-6xl mb-6">✓</div>
                        
                        <h2 class="text-4xl font-bold primary-color mb-4">Thank You, ${userData.name}!</h2>
                        
                        <div class="bg-green-50 rounded-xl p-6 mb-8">
                            <p class="text-lg text-gray-700 mb-3">A copy of your report will be shared within 2 business days at:</p>
                            <p class="text-xl font-semibold primary-color">${userData.email}</p>
                        </div>
                        
                        <p class="text-gray-600 mb-8">If you'd like to discuss your assessment in detail or explore how Effilor can help improve your Agile culture, we'd be happy to connect.</p>
                        
                        <div class="bg-purple-50 rounded-xl p-6">
                            <p class="text-sm text-gray-700">
                                <strong>Questions or need immediate assistance?</strong><br>
                                Contact us at lakshmi.athreya@effilor.com
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Navigation functions
        function startAssessment() {
            currentScreen = 'question';
            currentQuestion = 0;
            render();
        }

        function selectAnswer(value) {
            answers[currentQuestion] = value;
            
            // Auto-advance after a brief delay
            setTimeout(() => {
                if (currentQuestion === ASSESSMENT_DATA.totalQuestions - 1) {
                    currentScreen = 'results';
                    render();
                } else {
                    currentQuestion++;
                    render();
                }
            }, 300);
        }

        function nextQuestion() {
            if (!answers[currentQuestion]) return;
            
            if (currentQuestion === ASSESSMENT_DATA.totalQuestions - 1) {
                currentScreen = 'results';
                render();
            } else {
                currentQuestion++;
                render();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                // Don't clear the answer - let them see their previous choice
                render();
            }
        }

        function showEmailForm() {
            currentScreen = 'email';
            render();
        }

        function backToResults() {
            currentScreen = 'results';
            render();
        }

        async function submitForm(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            userData = {
                name: formData.get('input[type="text"]') || event.target.elements[0].value,
                email: formData.get('input[type="email"]') || event.target.elements[1].value,
                organization: event.target.elements[2].value,
                role: event.target.elements[3].value,
                phone: event.target.elements[4].value || 'Not provided'
            };
            
            const results = calculateResults();
            
            const submission = {
                userData,
                results,
                answers,
                timestamp: new Date().toISOString()
            };
            
            try {
                const response = await fetch('/api/send-email', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(submission)
                });
                
                if (response.ok) {
                    currentScreen = 'thankyou';
                    render();
                } else {
                    alert('There was an error submitting your information. Please try again or contact us directly at shankar.ramamurthy@effilor.com');
                }
            } catch (error) {
                console.error('Submission error:', error);
                alert('There was an error submitting your information. Please try again or contact us directly at shankar.ramamurthy@effilor.com');
            }
        }

        function render() {
            const app = document.getElementById('app');
            
            switch(currentScreen) {
                case 'welcome':
                    app.innerHTML = renderWelcome();
                    break;
                case 'question':
                    app.innerHTML = renderQuestion();
                    break;
                case 'results':
                    app.innerHTML = renderResults();
                    break;
                case 'email':
                    app.innerHTML = renderEmailForm();
                    break;
                case 'thankyou':
                    app.innerHTML = renderThankYou();
                    break;
            }
        }

        // Initialize
        render();
    </script>
</body>
</html>
